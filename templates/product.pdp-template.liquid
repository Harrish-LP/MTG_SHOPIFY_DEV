<!-- /templates/product.liquid --> 
{% assign variant_tmp = product.selected_or_first_available_variant | default: product.variants.first %}
{% assign featured_image = current_variant.featured_image | default: product.featured_image %}
{% include 'breadcrumb' %} 
{% assign media_col = settings.product_image_size %} 
{% assign main_col = 12 | minus: settings.product_image_size %}
{% if settings.product_addtocart_sticky != blank %}
<!-- Copyright FeedArmy 2019 Version 2.31 Modified by Isaiah Da-Manager.com-->
{% assign fa_current_variant = product.selected_or_first_available_variant %}
{% assign fa_variant_count = product.variants | size %}
{% assign fa_count = 0 %}

{% liquid
  assign meta = product.metafields.custom 
%}

<script>
document.addEventListener("DOMContentLoaded", function() {
  // Select the first <ul> inside the .metafield-rich_text_field container
  var ulElement = document.querySelector(".metafield-rich_text_field ul");
  
  if (ulElement) {
    var listItems = ulElement.querySelectorAll("li"); // Select all <li> elements within that <ul>
    
    if (listItems.length > 5) {
      // Apply column styles directly if more than 5 <li> items
      ulElement.style.columnCount = "2";
      ulElement.style.columnGap = "20px";
    }
  }
});
</script>

<script type="application/ld+json" data-creator_name="FeedArmy">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": "{{ product.title | strip_html | escape }}",
  "url": "{{ shop.url }}{{ product.url }}",
  {% if product.variants.first.sku != blank %}
    "sku": "{{ product.variants.first.sku }}",
  {% else %}
    "sku": "{{ product.variants.first.id }}",
  {% endif %}
  {% if product.variants.first.barcode.size == 12 %}
    "gtin12": {{ product.variants.first.barcode }},
  {% endif %}
  {% if product.variants.first.barcode.size == 13 %}
    "gtin13": {{ product.variants.first.barcode }},
  {% endif %}
  {% if product.variants.first.barcode.size == 14 %}
    "gtin14": {{ product.variants.first.barcode }},
  {% endif %}
    "productID": "{{ product.id }}",
  "brand": {
    "@type": "Thing",
    "name": "{{ product.vendor | escape }}"
  },
  "description": "{{ product.description | strip_html | escape | strip_newlines }}",
  "image": "https:{{ product.featured_image.src | img_url: 'grande' }}",
  {% if product.variants %}
  {% assign fa_count = fa_count | plus: 1 %}
    "offers": {% if product.variants.size > 1 %}[{% endif %}
      {
        "@type" : "Offer",
        "priceCurrency": "{{ shop.currency }}",
        "price": "{{ fa_current_variant.price | money_without_currency  | strip_html | remove: ',' }}",
        "itemCondition" : "http://schema.org/NewCondition",
        "availability" : "http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
        "url" : "{{ shop.url }}{{ fa_current_variant.url }}",


            {% if fa_current_variant.image %}
              {% assign variant_image_size = fa_current_variant.image.width | append: 'x' %}
              "image": "https:{{ fa_current_variant.image.src | img_url: variant_image_size }}",
            {% else %}
              "image": "https:{{ product.featured_image.src | img_url: 'grande' }}",
            {% endif %}
            {% if fa_current_variant.title != 'Default Title' %}
              "name" : "{{ product.title | strip_html | escape }} - {{ fa_current_variant.title | escape }}",
            {% else %}
              "name" : "{{ product.title | strip_html | escape }}",
            {% endif %}
            {% if fa_current_variant.barcode.size == 12 %}
              "gtin12": {{ fa_current_variant.barcode }},
            {% endif %}
            {% if fa_current_variant.barcode.size == 13 %}
              "gtin13": {{ fa_current_variant.barcode }},
            {% endif %}
            {% if fa_current_variant.barcode.size == 14 %}
              "gtin14": {{ fa_current_variant.barcode }},
            {% endif %}
            {% if fa_current_variant.sku != blank %}
              "sku": "{{ fa_current_variant.sku }}",
            {% else %}
              "sku": "{{ fa_current_variant.id }}",
            {% endif %}
            {% if product.description != blank %}
            "description" : "{{ product.description | strip_html | escape | strip_newlines }}",
            {% endif %}
          "priceValidUntil": "{{ 'now' | date: '%s' | plus: 31536000 | date: '%Y-%m-%d' | uri_encode | replace:'+','%20' }}"

      }{% if product.variants.size != 1 %},{% endif %}

      {% for variant in product.variants %}
      {% assign fa_count = fa_count | plus: 1 %}
      {% if variant != product.selected_or_first_available_variant %}
        {
          "@type" : "Offer",
          "priceCurrency": "{{ shop.currency }}",
          "price": "{{ variant.price | money_without_currency  | strip_html | remove: ',' }}",
          "itemCondition" : "http://schema.org/NewCondition",
          "availability" : "http://schema.org/{% if variant.available %}InStock{% else %}OutOfStock{% endif %}",
          "url" : "{{ shop.url }}{{ variant.url }}",


              {% if variant.image %}
                {% assign variant_image_size = variant.image.width | append: 'x' %}
                "image": "http:{{ variant.image.src | img_url: variant_image_size }}",
              {% else %}
                "image": "https:{{ product.featured_image.src | img_url: 'grande' }}",
              {% endif %}
              {% if variant.title != 'Default Title' %}
                "name" : "{{ product.title | strip_html | escape }} - {{ variant.title | escape }}",
              {% else %}
                "name" : "{{ product.title | strip_html | escape }}",
              {% endif %}
              {% if variant.barcode.size == 12 %}
                "gtin12": {{ variant.barcode }},
              {% endif %}
              {% if variant.barcode.size == 13 %}
                "gtin13": {{ variant.barcode }},
              {% endif %}
              {% if variant.barcode.size == 14 %}
                "gtin14": {{ variant.barcode }},
              {% endif %}
              {% if variant.sku != blank %}
                "sku": "{{ variant.sku }}",
              {% else %}
                "sku": "{{ variant.id }}",
              {% endif %}
              {% if product.description != blank %}
              "description" : "{{ product.description | strip_html | escape | strip_newlines }}",
              {% endif %}
              "priceValidUntil": "{{ 'now' | date: '%s' | plus: 31536000 | date: '%Y-%m-%d' | uri_encode | replace:'+','%20' }}"
          }

          {% if fa_count <= fa_variant_count %}
         	{% unless forloop.last %},{% endunless %}
          {% endif %}

          {% endif %}





      {% endfor %}
    {% if product.variants.size > 1 %}]{% endif %}

    {% if product.metafields.spr.reviews %}
    ,"aggregateRating": {
     "@type": "AggregateRating",
     "ratingValue": {{ product.metafields.spr.reviews | split: 'ratingValue" content="' | last | split: '"' | first | plus: 0 }},
     "ratingCount": {{ product.metafields.spr.reviews | split: 'reviewCount" content="' | last | split: '"' | first | plus: 0 }}
    }
    {% endif %}
  {% endif %}
}
</script>
<!-- Copyright FeedArmy 2019 Version 2.31 Modified by Isaiah Da-Manager.com -->

{{ 'pdp.css' | asset_url | stylesheet_tag }}


{% comment %} <div class="sticky-product hide">
  <div class="container">
    <div class="sticky-image">
      {% assign featured_image = current_variant.featured_image | default: product.featured_image %}
      <img id="image-main" class="visible" src="{{ featured_image | product_img_url: '50x50' }}"/> 
    </div>
    <div class="sticky-detail">
      <div class="product-name-area">
        <h2 class="product-name">
          {% if settings.language_enable %}
          <span class="lang1">{{ product.title | split: '|' | first }}</span>
          <span class="lang2">{{ product.title | split: '|' | last }}</span>
          {% else %}
          {{ product.title | split: '|' | first }}
          {% endif %}
        </h2> 
        <div class="price-box"></div> 
      </div>
      <div class="ratings">
        <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
      </div>
      <p class="availability in-stock"></p>
    </div>
    <div class="add-to-cart-clone">
      {% if product.available %}
      <button type="button" id="product-addtocart-button-clone">
        <i class="icon-cart"></i>
        <span><span {% if settings.language_enable %}data-translate="products.product.add_to_cart"{% endif %}>{{ 'products.product.add_to_cart' | t }}</span></span>
      </button>
      {% else %}
      <button type="button" id="product-addtocart-button-clone">
        <i class="icon-cart"></i>
        <span {% if settings.language_enable %}data-translate="products.product.sold_out"{% endif %}>{{ 'products.product.sold_out' | t }}</span>
      </button>
      {% endif %}
    </div>
  </div>
</div> {% endcomment %}
<script type="text/javascript">
  var p_scrolled = false;
  $(window).scroll(function(){
    if(400<$(window).scrollTop() && !p_scrolled){
      if($('.sticky-header').length > 0) {
        $('.sticky-product').addClass('has-sticky-header');
      }
      p_scrolled = true;
      $('.middle-product-detail .detail-price > *').each(function(){
        $(this).parent().append($(this).clone());
        var tmp = $(this).detach();
        $('.sticky-product .price-box').append(tmp);
      });
      $(".sticky-product").removeClass("hide");
      $(".actions .button-wrapper-content button").off("DOMSubtreeModified").on("DOMSubtreeModified",function(){
        $("#product-addtocart-button-clone span").html($(this).text()); 
      });
    }
    if(400>=$(window).scrollTop() && p_scrolled){
      p_scrolled = false; 
      $('.middle-product-detail .detail-price > *').remove();
      $('.sticky-product .price-box > *').each(function(){
        var tmp = $(this).detach();
        $('.middle-product-detail .detail-price').append(tmp);
      });
      $(".sticky-product").addClass("hide");
    }
    isStickyMobile();
  });
  function isStickyMobile() {
    var width = $(window).width();
    if(width < 992) {   
      if($('.header-container').css('position')=='relative') { 
        $(".sticky-product").css('top', 0);
      }else{
        $(".sticky-product").css('top', $('.header-container').height());
      }
    }else{
      $(".sticky-product").css('top', '');
    } 
  }
  isStickyMobile();
  $(window).resize(function(){
    isStickyMobile();
  });
  $("#product-addtocart-button-clone").click(function(){ 
    $(".product-options-bottom .btn-cart.add-to-cart").trigger("click");
  });
</script>
{% endif %}

<div class="container c-container">
  <div class="pdp-container">
    <div class="pdp-border pdp-nav">
      <div class="pdp-anchor">
        <a href="#summary_link"><h2>Summary</h2></a>
        <a href="#course_overview_link"><h2>Course overview</h2></a>
        <a href="#course_content_link"><h2>Course content</h2></a>
        <a href="#audience_link"><h2>Target audience</h2></a>
        <a href="#course_aims_link"><h2>Course aims</h2></a>
        <a href="#learnings_link"><h2>What you’ll learn</h2></a>
        {%- if meta.pdp_interactive_demo != blank -%}
          <a href="#interactive_demo_link"><h2>Interactive demo</h2></a>  
         {%- endif -%}
        <a href="#certifications_link"><h2>Certifications</h2></a>
        <a href="#faq_link"><h2>Faqs</h2></a>
        <a href="#reviews_link"><h2>Reviews</h2></a>
        <div class="anchor-end"></div>
      </div>
      <div class="pdp-categories">
        <h2>Categories</h2>
        {% for link in settings.pdp_link_list.links %}
          <div>
            <a href="{{ link.url }}">{{ link.title }}</a>
          </div>
        {% endfor %}
      </div>
    </div>
    <div class="c_product-img-list desktop-hide">
      {% include 'c_media' %}
    </div>
    <div class="pdp-border pdp-main" id="summary_link">
      <div style="display: flex;">
        <div>
          <h1>{{ product.title }}</h1>
          <div class="main-content">
            {% if meta.pdp_description != blank %}
              {{ meta.pdp_description | metafield_tag}}
            {% else %}
              {{ settings.default_description }}
            {% endif %}
          </div>
        </div>
        {% if settings.disable_addtolink == blank %}
          <div class="action-list wishlist desktop-hide" style="align-items: right;">
            {% render 'c_wishlist-item2'%}
          </div>
          {% endif %}
      </div>
      <div class="pdp-product-details">
        <div class="pdp-detail-content-container">
          <div class="pdp-detail-content">
            <p class="w-b p-color product-space">Price:</p>
            {% if variant_tmp.compare_at_price > variant_tmp.price %}
              <s style="padding-right: 1rem;" class="p-color old-price detail-price"> £ {{ variant_tmp.compare_at_price | money_without_currency }} + VAT</s>
            {% endif %} 
            <p>£{{ product.price | money_without_currency}} + VAT</p>
          </div>
          {% if meta.pdp_summary_level != blank %}
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Level:</p>
              <p> {{ meta.pdp_summary_level }} </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_duration != blank %}            
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Duration:</p>
              <p> {{ meta.pdp_summary_duration }} Minutes </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_method != blank %}         
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Method:</p>
              <p> {{ meta.pdp_summary_method}} </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_platform != blank %}            
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Platform:</p>
              <p> {{ meta.pdp_summary_platform }} </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_access_expiry != blank %}            
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Course access expiry:</p>
              <p> {{ meta.pdp_summary_access_expiry }} </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_certificate_validity != blank %}
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Certificate validity:</p>
              <p> {{ meta.pdp_summary_certificate_validity }} </p>
            </div>
          {% endif %}
          {% if meta.pdp_summary_last_audited != blank %}
            <div class="pdp-detail-content">
              <p class="w-b p-color product-space">Last audited:</p>
              <p> {{ meta.pdp_summary_last_audited }} </p>
            </div>
          {% endif %}
        </div>
        <div class="pdp-detail-content-container">
          <div class="pdp-detail-content">
            <p class="w-b p-color product-space">Rating:</p>
            <div>
              <a href="#looxReviews">
                <div class="loox-rating" data-id="{{ product.id }}" data-rating="{{ product.metafields.loox.avg_rating }}" data-raters="{{ product.metafields.loox.num_reviews }}"></div>
              </a>
              {% comment %} <div style="height: 3rem; padding-top: 1rem;" >
                <div class="trustpilot-widget" data-locale="en-GB" data-style-alignment="left" data-style-height="100%" data-template-id="577258fb31f02306e4e3aaf9" data-businessunit-id="5edcfad73b124600010ea146" data-style-width="100%" data-sku="{{ product.selected_or_first_available_variant.sku }}" data-no-reviews="show" data-scroll-to-list="true" data-style-alignment="center">
                  <a href="https://uk.trustpilot.com/review/mandatorytraining.co.uk" target="_blank" rel="noopener">Trustpilot</a>
                </div>
              </div> {% endcomment %}
            </div>
          </div>
          {% if settings.pdp_payment_method_klarna != false or settings.pdp_image_picker_ae != false or settings.pdp_image_picker_vm != false or settings.pdp_image_picker_ap != false %}
            <div class="product-space pdp-accepted-payment-sections">
                <p class="w-b p-color ">Accepted payments:</p>
                <div class="pdp-accepted-payments">
                  {% if settings.pdp_payment_method_klarna != false %}
                    <div><img src="{{ settings.pdp_image_picker_klarna |  image_url  }}" /></div>
                  {% endif %}
                  {% if settings.pdp_payment_method_ae != false %}
                      <div><img src="{{ settings.pdp_image_picker_ae | image_url  }}" /></div>
                  {% endif %}
                  {% if settings.pdp_payment_method_vm != false %}
                      <div><img src="{{ settings.pdp_image_picker_vm | image_url  }}" /></div>
                  {% endif %}
                  {% if settings.pdp_payment_method_ap != false %}
                      <div><img src="{{ settings.pdp_image_picker_ap | image_url  }}" /></div>
                  {% endif %}
                </div>
            </div>
            {% if meta.pdp_cpd_logo == blank %}
              <div class="product-space pdp-cpd-logo">
                <img src="{{  settings.pdp_cpd_logo |  image_url }}" />  
              </div>
            {% else %}
              <div class="product-space pdp-cpd-logo">
                  <img src="{{  meta.pdp_cpd_logo }}" />  
              </div>
          {% endif %} 
        {% endif %} 
        </div>
      </div>
      <form class="pt product-form desktop-hide" id="product-main-form" action="/cart/add" method="post" enctype="multipart/form-data" data-product-id="{{product.id}}" data-id="{{ product.handle }}"> 
        <div id="product-variants" class="product-options" {% if product.options.size == 1 and product.options.first == 'Title' %}style="display: none;"{% endif %}> 
          <select id="product-selectors" name="id" style="display: none;">
            {% for variant in product.variants %}
            {% if variant.available %}
            <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money_with_currency }}</option>
            {% else %}
            <option disabled="disabled">
              {{ variant.title }} - {{'products.product.sold_out' | t}}
            </option>
            {% endif %}
            {% endfor %}
          </select> 
        </div>  
        <div class="product-options-bottom"> 
          <div class="add-to-cart-box custom-add-to-cart-box">
            <div class="input-box pull-left"> 
              <div class="phar">
                <p style="font-size: 2rem">Quantity</p>
              </div>
              <div class="quantity-input" >
                <div class="reduced items" onclick="var result = document.getElementById('qty2'); var qty2 = result.value; if( !isNaN( qty2 ) &amp;&amp; qty2 > 1 ) result.value--;return false;">
                  <i class="icon-down-dir"></i>
                </div>
                <input type="text" id="qty2" name="quantity" value="1" min="1" class="quantity-selector"> 
                <div class="increase items" onclick="var result = document.getElementById('qty2'); var qty2 = result.value; if( !isNaN( qty2 )) result.value++;return false;">
                  <i class="icon-up-dir"></i>
                </div>
              </div>
            </div>
            {% comment %} Temp remove until further notice {% endcomment %}
            {% comment %} <div class="input-box pull-left" style="justify-content: center;" > 
              <input type="checkbox" id="sales_rep" name="sales_rep" class="checkbox"  style="margin-right: 5px"/>
              <label id="modalLabel" for="sales_rep" class="contact_sales" style="margin-top: 5px;">Buying for a large team!</label>
            </div> {% endcomment %}

            <div class="actions">
              <div class="action-list addtocart" style="width: 100%">
                <div class="button-wrapper" style="width: 100%">
                  {% if product.available %}
                  <div class="button-wrapper-content" style="width: 100%">
                    <button type="submit" name="add" class="btn-cart add-to-cart bordered uppercase product-basket-button" style="width: 100% !important">                      
                      <span>
                        <span {% if settings.language_enable %}data-translate="products.product.add_to_cart"{% endif %}>{{ 'products.product.add_to_cart' | t }}</span>
                      </span>
                    </button> 
                  </div>
                  {% else %} 
                  <div class="button-wrapper-content" style="width: 100%">
                    <i class="icon-cart"></i>
                    <button href="javascript:;" class="btn-cart add-to-cart product-basket-button" style="width: 100% !important">
                      <span>
                        <span {% if settings.language_enable %}data-translate="products.product.sold_out"{% endif %}>{{ 'products.product.sold_out' | t }}</span>
                      </span>
                    </button>  
                  </div>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>   
      {% if settings.pdp_global_testimonial != blank %}
        <div class="anchor-end pdp-pt" style="margin-top: 1rem;" id="testimonial_link">
          <h2>Testimonials</h2>

          {% include 'pdp_testimonials' %}
        </div>
      {% endif %}
      <div class="anchor-end pdp-pt" style="margin-top: 1rem; padding-bottom: 20px;" id="course_overview_link">
        <h2>Course overview</h2>
        {{ meta.pdp_course_overview_contents | metafield_tag  }}
        {% if meta.pdp_course_overview_pdf != blank%}
          {% comment %} <a style="font-style: italic; color: #00af52 !important; margin-bottom: 10px;"class="w-b p-color" target="_blank" href="{{ meta.pdp_course_overview_pdf | file_url }}">Download the course brochure here. Full details inside.</a> {% endcomment %}
           <div style="margin-bottom: 25px;"></div> <!-- This is added for spacing -->
          <a class="dl-brochure-btn" style="" target="_blank" href="{{ meta.pdp_course_overview_pdf | file_url }}">Download Brochure</a>
          <style>
            .dl-brochure-btn{color: white; font-size: 14px; background-color: #212c4b; padding: 10px; border-radius: 5px;transition: all 0.2s ease-in-out;}
            .dl-brochure-btn:hover{background-color: #2a3556; color: white;}
            .dl-brochure-btn:focus{color: white;}
          </style>
        {% endif %}
        
      </div>
      <div class="anchor-end pdp-pt" id="course_content_link">
        <h2>Course content</h2>
        <div class="pdp-course-content">
          <div>
            {{ meta.pdp_course_content_sections |  metafield_tag }}
          </div>
        </div>
      </div>
      <div class="anchor-end pdp-pt" id="audience_link">
        <h2>Who is this course for?</h2>
        <div class="bullet-design">
          {{ meta.pdp_course_for | metafield_tag }}
        </div>
      </div>
      <div class="anchor-end pdp-pt" id="course_aims_link">
        <h2>Aims</h2>
        <div class="bullet-design">
          {{ meta.pdp_aims_content | metafield_tag  }}
        </div>
      </div>
      <div class="pdp-learning pdp-pt"  id="learnings_link">
        {%- if meta.pdp_learning_objectives != blank or meta.pdp_learning_objectives_image != blank -%}
          <div class="anchor-right">
            <h2>Learning objectives</h2>
            <div class="bullet-design">
              {{ meta.pdp_learning_objectives | metafield_tag  }}
            </div>
            <img src="{{  meta.pdp_learning_objectives_image }}" />  
          </div>
        {%- endif -%}
          <div class="{% if meta.pdp_learning_objectives != blank or meta.pdp_learning_objectives_image != blank %}anchor-left line-br{% endif %}">
            <h2>Learning outcomes</h2>
            <div class="bullet-design">
              {{ meta.pdp_learning_outcomes | metafield_tag  }}
            </div>
            {%- if meta.pdp_learning_outcomes_image != blank -%}
              <img src="{{  meta.pdp_learning_outcomes_image}}" />  
            {%- endif -%}
          </div>
      </div>
      <div class="anchor-end pdp-pt"></div>
      {%- if meta.pdp_interactive_demo != blank -%}
        <div
        class="anchor-end pdp-pt"
        style="padding-bottom: 24px"
        id="interactive_demo_link"
        >
          <h2>Interactive demo</h2>
          <iframe width="100%" height="315" src="{{ meta.pdp_interactive_demo }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
          </iframe>
      </div>
      {%- endif -%}
      {% if meta.pdp_certifications_course_assesment != blank or meta.pdp_certifications_course_certifications != blank or meta.pdp_certifications_course_accreditation != blank  %}
        <div class="anchor-end" id="certifications_link">
          {% if meta.pdp_certifications_course_assesment != blank %}
            <div class="pdp-certifications">
              <div>
                <p class="w-b" style="font-size: 18px">
                  End of course assessment
                </p>
                <div class="bullet-design">
                  {{ meta.pdp_certifications_course_assesment | metafield_tag  }}
                </div>
              </div>
            
              <div class="pdp-certifications-image-style">
                <img src="https://cdn.shopify.com/s/files/1/0706/8965/2977/files/school-online.png?v=1725436896" class="pdp-certification-image" />
              </div>
            </div>
          {% endif %}
            
          {% if meta.pdp_certifications_course_certifications != blank %}
            <div class="pdp-certifications">
              <div class="pdp-certifications-cert-style">
                <p class="w-b" style="font-size: 18px">Certification</p>
                <div class="bullet-design">
                  {{ meta.pdp_certifications_course_certifications| metafield_tag  }}
                </div>
              </div>
              <div class="pdp-certifications-image-style">
                <img src="https://cdn.shopify.com/s/files/1/0706/8965/2977/files/certificate_d247333e-447c-4dca-81f8-2f0802b6909f.png?v=1725436896" class="pdp-certification-image" />
              </div>
            </div>
          {% endif %}
          {% if meta.pdp_certifications_course_accreditation != blank %}
            <div class="pdp-certifications">
              <div>
                <p class="w-b" style="font-size: 18px">Course accreditation</p>
                <div class="bullet-design">
                  {{ meta.pdp_certifications_course_accreditation | metafield_tag  }}
                </div>
              </div>
              <div class="pdp-certifications-image-style">
                <img src="https://cdn.shopify.com/s/files/1/0706/8965/2977/files/verify.png?v=1725436896" class="pdp-certification-image" />
              </div>
            </div>
            {% endif %}
          {% if meta.pdp_cpd_logo == blank %}
            <div class="cs-cpd">
              <img src="{{  settings.pdp_cpd_logo |  image_url }}" />  
            </div>
          {% else %}
            <div class="cs-cpd">
                <img src="{{  meta.pdp_cpd_logo }}" />  
            </div>
          {% endif %} 
        </div>
      {% endif %}

      <div id="faq_link" class="pdp-pt">  
        <h2>FAQs</h2>
        {%- assign faqs = product.metafields.custom.pdp_faq.value -%}
        {% if faqs != blank %}
          <div class="product-faq">
            {% for faq in faqs %}
              <details class="details">
                <summary><i class="fa-solid fa-chevron-down"></i>{{ faq.question }}</summary>
                <p>{{ faq.answer }}</p>
              </details>
            {%- endfor -%}
          </div>
        {% endif %}
        {{ settings.default_faq }}
      </div>
      <div class="info-card">
        <h3>Login steps</h3>
        {{ settings.pdp_login_inst }}
      </div>
      <div class="pdp-pt"  id="reviews_link">
        <h2>Reviews</h2>
          <!-- TrustBox widget - Product Reviews MultiSource SEO -->
          {% comment %} <div class="trustpilot-widget" data-locale="en-GB" data-template-id="5763bccae0a06d08e809ecbb" data-businessunit-id="5edcfad73b124600010ea146" data-style-height="400" data-style-width="100%" data-sku="{{ product.selected_or_first_available_variant.sku }}" data-name="{{ product.selected_or_first_available_variant.title }}" data-review-languages="en" data-no-reviews="show" data-fullwidth="true">
            <a href="https://uk.trustpilot.com/review/mandatorytraining.co.uk" target="_blank" rel="noopener">Trustpilot</a>
          </div> {% endcomment %}
          <!-- End TrustBox widget -->
      </div>
       <div class="pdp-pt">
        <div id="looxReviews" data-product-id="{{product.id}}" class="loox-reviews-default">{{ product.metafields.loox.reviews }}</div>
      </div> 
    </div>
    <div class="pdp-border pdp-product-basket mobile-hide">
      <div class="product-img-box">
        <div class="c_product-img-list">
          {% include 'c_media' %}
        </div>
      </div> 
      <p style="text-align: center; font-weight: bold">
        Learn. <span style="color: #00af52"> Develop.</span> Comply.
      </p>
      <div class="product-type-main">  
        <form class="product-form" id="product-main-form" action="/cart/add" method="post" enctype="multipart/form-data" data-product-id="{{product.id}}" data-id="{{ product.handle }}"> 
          <div id="product-variants" class="product-options" {% if product.options.size == 1 and product.options.first == 'Title' %}style="display: none;"{% endif %}> 
            <select id="product-selectors" name="id" style="display: none;">
              {% for variant in product.variants %}
              {% if variant.available %}
              <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money_with_currency }}</option>
              {% else %}
              <option disabled="disabled">
                {{ variant.title }} - {{'products.product.sold_out' | t}}
              </option>
              {% endif %}
              {% endfor %}
            </select> 
          </div>  
          <div class="product-options-bottom"> 
            <div class="add-to-cart-box custom-add-to-cart-box">
              <div class="input-box pull-left"> 
                <div class="phar">
                  <p>Quantity</p>
                </div>
                <div class="quantity-input" >
                  <div class="reduced items" onclick="var result = document.getElementById('qty1'); var qty1 = result.value; if( !isNaN( qty1 ) &amp;&amp; qty1 > 1 ) result.value--;return false;">
                    <i class="icon-down-dir"></i>
                  </div>
                  <input type="text" id="qty1" name="quantity" value="1" min="1" class="quantity-selector"> 
                  <div class="increase items" onclick="var result = document.getElementById('qty1'); var qty1 = result.value; if( !isNaN( qty1 )) result.value++;return false;">
                    <i class="icon-up-dir"></i>
                  </div>
                </div>
              </div>
              {% comment %} Temp remove until further notice {% endcomment %}
              {% comment %} <div class="input-box pull-left" style="justify-content: center;" > 
                <input type="checkbox" id="sales_rep" name="sales_rep" class="checkbox"  style="margin-right: 5px"/>
                <label id="modalLabel" for="sales_rep" class="contact_sales" style="margin-top: 5px;">Buying for a large team!</label>
              </div> {% endcomment %}

              <div class="actions">
                <div class="action-list addtocart">
                  <div class="button-wrapper">
                    {% if product.available %}
                    <div class="button-wrapper-content">
                      <button type="submit" name="add" class="btn-cart add-to-cart bordered uppercase product-basket-button">                      
                        <span>
                          <span {% if settings.language_enable %}data-translate="products.product.add_to_cart"{% endif %}>{{ 'products.product.add_to_cart' | t }}</span>
                        </span>
                      </button> 
                    </div>
                    {% else %} 
                    <div class="button-wrapper-content">
                      <i class="icon-cart"></i>
                      <button href="javascript:;" class="btn-cart add-to-cart product-basket-button">
                        <span>
                          <span {% if settings.language_enable %}data-translate="products.product.sold_out"{% endif %}>{{ 'products.product.sold_out' | t }}</span>
                        </span>
                      </button>  
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% if settings.disable_addtolink == blank %}
                <div class="action-list wishlist">
                  {% include 'c_wishlist-item'%}
                </div>
                {% endif %}
              </div>
            </div>
          </div>
        </form>   
      </div>
      <div style="width: 100%; text-align: center; padding-bottom: 2rem">
        <div class="product-basket-padding">
          <div class="product-basket-bg-color">
            <p>Instant access</p>
            <p>100% money back guarantee</p>
            <p>24/7 online support</p>
            <p>Learn anytime. anywhere.</p>
            <p>Assessment and certification</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const salesUrl = "{{ settings.sales_url }}";
    const salesRepCheckbox = document.getElementById("sales_rep");
    const button = document.querySelector(".btn-cart.add-to-cart");

    function updateButtonState(isChecked) {
        if (isChecked) {
            button.textContent = "Contact Sales";
            button.setAttribute("type", "button");
            button.onclick = function () {
                window.location.href = salesUrl;
            };
        } else {
            button.innerHTML = `<span data-translate="products.product.add_to_cart">{{ 'products.product.add_to_cart' | t }}</span>`;
            button.setAttribute("type", "submit"); 
            button.onclick = null;
        }
    }

    if (localStorage.getItem("salesRepChecked") === "true") {
        salesRepCheckbox.checked = true;
        updateButtonState(true);
    }

    salesRepCheckbox.addEventListener("change", function () {
        localStorage.setItem("salesRepChecked", this.checked);
        updateButtonState(this.checked);
    });
});

</script>


    <script>
      productsObj.id{{product.id}} = {{product | json}};
      $(document).ready(function() {
        {% if settings.move_product_tab != blank %}
        $(".product-shop .middle-product-detail").before($(".product-tabs"));
        $(".product-shop .middle-product-detail").before($(".product-tab-accordion")); 
        {% endif %}
      });
      selectCallback = function(variant, selector) {
        if (variant) {
          if (variant.compare_at_price > variant.price) { 
            $("#price").html('<del class="price_compare">' + Shopify.formatMoney(variant.compare_at_price, money_format) + "</del>" + '<div class="price">' + Shopify.formatMoney(variant.price, money_format) + "</div>")
          } else {
            $("#price").html('<div class="price">' + Shopify.formatMoney(variant.price, money_format) + "</div>");
          }
          if (variant.available) {
            frontendData.enableCurrency && currenciesCallbackSpecial("#price span.money"), 
              $(".product-page-area .product-shop .add-to-cart").removeClass("disabled").removeAttr("disabled").html(window.inventory_text.add_to_cart), 
              variant.inventory_management && variant.inventory_quantity <= 0 ? ($("#selected-variant").html(selector.product.title + " - " + variant.title), $("#backorder").removeClass("hidden")) : $("#backorder").addClass("hidden");
            if (variant.inventory_management!=null) {
              $(".product-inventory span.in-stock").text(window.inventory_text.in_stock);
            } else {
              $(".product-inventory span.in-stock").text(window.inventory_text.many_in_stock);
            }
            $('.product-sku span.sku').text(variant.sku);
          }else{
            $("#backorder").addClass("hidden"), $(".product-page-area .add-to-cart").html(window.inventory_text.sold_out).addClass("disabled").attr("disabled", "disabled");
            $(".product-inventory span.in-stock").text(window.inventory_text.out_of_stock);
            $('.product-sku span.sku').empty();
          }
          if( swatch_color_type == '1' || swatch_color_type == '2' ){ 
            var form = $('#' + selector.domIdPrefix).closest('form');
            for (var i=0,length=variant.options.length; i<length; i++) {
              var radioButton = form.find('.swatch[data-option-index="' + i + '"] :radio[value="' + variant.options[i] +'"]');
              if (radioButton.size()) { 
                radioButton.get(0).checked = true;
              }
            } 
          }  
        } 
        if (variant && variant.featured_image) {
          var n = Shopify.Image.removeProtocol(variant.featured_image.src);   
          $(".product-image-thumbs .thumb-link").filter('[data-zoom-image="' + n + '"]').trigger("mouseenter"); 
        }
        variant && variant.sku ? $("#sku").removeClass("hidden").find("span").html(variant.sku) : $("#sku").addClass("hidden").find("span").html("");
      };
      convertToSlug= function(e) { 
        return e.toLowerCase().replace(/[^a-z0-9 -]/g, "").replace(/\s+/g, "-").replace(/-+/g, "-")
      };
      jQuery(function($) {
        {% if product.available and product.variants.size >= 1 %} 
        var product = {{product | json}};
        var layout = $('.product-page-area'); 
        if (product.variants.length >= 1) { //multiple variants
          for (var i = 0; i < product.variants.length; i++) {
            var variant = product.variants[i];
            var option = '<option value="' + variant.id + '">' + variant.title + '</option>'; 
            layout.find('form.product-form > select').append(option);
          }
          new Shopify.OptionSelectors("product-selectors", {
            product: product,
            onVariantSelected: selectCallback, 
            enableHistoryState: true
          });

          //start of quickview variant;
          var filePath = asset_url.substring(0, asset_url.lastIndexOf('/'));
          var assetUrl = asset_url.substring(0, asset_url.lastIndexOf('/'));
          var options = ""; 
          for (var i = 0; i < product.options.length; i++) {
            options += '<div class="swatch clearfix" data-option-index="' + i + '">';
            options += '<div class="header">' + product.options[i] + '</div>';
            var is_color = false;
            var is_square = 'square';
            if (/Color|Colour/i.test(product.options[i])) {
              is_color = true;
            } 
            if (swatch_color_type == '2') {
              is_color = false;
              is_square = '';
            } 
            var optionValues = new Array();
            for (var j = 0; j < product.variants.length; j++) {
              var variant = product.variants[j];
              var value = variant.options[i];
              if(variant.featured_image && product_swatch_setting == '2'){ 
                var img = variant.featured_image.src.lastIndexOf("."); 
                var vimg = variant.featured_image.src.slice(0, img) + "_50x50_crop_center" + variant.featured_image.src.slice(img); 
              }  
              var valueHandle = convertToSlug(value);
              var forText = 'swatch-' + i + '-' + valueHandle; 
              if (optionValues.indexOf(value) < 0) {
                //not yet inserted
                options += '<div data-value="' + value + '" class="swatch-element '+is_square+' '+product_swatch_size+' '+(is_color ? "color" : "")+' ' + (is_color ? "color" : "") + valueHandle + (variant.available ? ' available ' : ' soldout ') + '">';

                if (is_color) {
                  options += '<div class="tooltip">' + value + '</div>';
                }
                options += '<input id="' + forText + '" type="radio" name="option-' + i + '" value="' + value + '" ' + (j == 0 ? ' checked ' : '') + (variant.available ? '' : ' disabled') + ' />';

                if (is_color) {
                  if(vimg && product_swatch_setting == '2'){ 
                    options += '<label for="' + forText + '" class="swatch-image" style="overflow:hidden;"><img src="' + vimg + '" class="variant-image" style="max-width:100%;" /><img class="crossed-out" src="' + assetUrl + 'soldout.png" /></label>';
                  }else{
                    options += '<label for="' + forText + '" style="background-color: ' + valueHandle + '; background-image: url(' + filePath + valueHandle + '.png)"><img class="crossed-out" src="' + assetUrl + 'soldout.png" /></label>';
                  }
                } else {
                  options += '<label for="' + forText + '">' + value + '<img class="crossed-out" src="' + assetUrl + 'soldout.png" /></label>';
                }
                options += '</div>';
                if (variant.available) {
                  $('.product-page-area .swatch[data-option-index="' + i + '"] .' + valueHandle).removeClass('soldout').addClass('available').find(':radio').removeAttr('disabled');
                }
                optionValues.push(value);
              }
            }
            options += '</div>';
          }  
          if(swatch_color_type == '1' || swatch_color_type == '2'){ 
            layout.find('form.product-form .product-options > select').after(options);
            layout.find('.swatch :radio').change(function() {
              var optionIndex = $(this).closest('.swatch').attr('data-option-index');
              var optionValue = $(this).val(); 
              $(this)
              .closest('form')
              .find('.single-option-selector')
              .eq(optionIndex)
              .val(optionValue)
              .trigger('change');
            }); 
          } 
			
          if (product.available) {
            Shopify.optionsMap = {};
            Shopify.linkOptionSelectors(product);
          }
          //end of quickview variant
        } else { //single variant
          layout.find('form.product-form .product-options > select').remove();
          var variant_field = '<input type="hidden" name="id" value="' + product.variants[0].id + '">';
          layout.find('form.product-form').append(variant_field);
        }
        {% endif %} 
      });
    </script>
  </div>
</div>
{% if settings.full_width_product_tab != blank and settings.move_down_product_tab_related == blank %}
<div class="product-view">
  <div class="product-collateral">
    <div class="container">
      <div class="product-description rte" itemprop="description">
        {% section 'product-page-tab' %}
      </div> 
    </div>
  </div>
</div>
{% endif %}
{% if settings.related_product_display %}
{% if settings.full_width_background_related != blank %}
<div class="full-width products-related {% if settings.style_product_view == '1' %}product_type_1{% endif %}{% if settings.style_product_view == '2' %}product_type_2{% endif %}{% if settings.style_product_view == '3' %}product_type_3{% endif %}{% if settings.style_product_view == '4' %}product_type_4{% endif %}">
  <div class="container">
    <div class="box_product_related">
      {% if settings.related_product_type == "tags" %}
      {% include 'related-products-by-tags' %}
      {% else %}
      {% include 'related-products' %}
      {% endif %}
    </div>
    <style>
      .main-container .main-wrapper {
        padding-top: 0;
        padding-bottom: 0; 
      }
      .main-container {
        padding-bottom: 0;
      }
    </style>
  </div>
</div>
{% endif %}
{% endif %}
{% if settings.full_width_product_tab != blank and settings.move_down_product_tab_related != blank %}
<div class="product-view">
  <div class="product-collateral">
    <div class="container">
      <div class="product-description rte" itemprop="description">
        {% section 'product-page-tab' %}
      </div> 
    </div>
  </div>
</div>
{% endif %} 
<script type="text/javascript">
  jQuery(function($){   
    $('.canvas-icon, .close-mobile-canvas').click(function(event) { 
      if(!$('body').hasClass('mobile-canvas-shown')) {
        $('body').addClass('mobile-canvas-shown', function() { 
          setTimeout(function(){
            $(document).one("click",function(e) {
              var target = e.target;
              if (!$(target).is('.block-main-canvas .block') && !$(target).parents().is('.block-main-canvas .canvas-inner')) {
                $('body').removeClass('mobile-canvas-shown');
              }
            });  
          }, 111);
        });
      } else{
        $('body').removeClass('mobile-canvas-shown');
      }
    }); 
  });
</script>
<style>
  .custom--description .accordion__title svg {
    display: none;
}
  @media(max-width: 991px){
    .canvas-inner {padding-top: 20px;}
  }
</style>
